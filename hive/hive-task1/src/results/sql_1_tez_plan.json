{
  "optimizedSQL": "SELECT `name`, `year`, `month`, `max_tmpr_diff`\nFROM (SELECT `name`, `wthr_year` AS `year`, `wthr_month` AS `month`, MAX(ROUND(ABS(MAX(`avg_tmpr_c`) - MIN(`avg_tmpr_c`)), 2)) AS `max_tmpr_diff`, MAX(ROUND(ABS(MAX(`avg_tmpr_c`) - MIN(`avg_tmpr_c`)), 2)) AS `_o__col10`\nFROM `default`.`hotel_weather`\nGROUP BY `name`, `wthr_year`, `wthr_month`\nORDER BY MAX(ROUND(ABS(MAX(`avg_tmpr_c`) - MIN(`avg_tmpr_c`)), 2)) DESC\nLIMIT 10) AS `t4`",
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
        "DagId:": "hive_20191204110345_43aff0ee-ad50-4c27-ba95-6d7ebc2cf07b:53",
        "Edges:": {
          "Reducer 2": {
            "parent": "Map 1",
            "type": "SIMPLE_EDGE"
          },
          "Reducer 3": {
            "parent": "Reducer 2",
            "type": "SIMPLE_EDGE"
          }
        },
        "DagName:": "hive_20191204110345_43aff0ee-ad50-4c27-ba95-6d7ebc2cf07b:53",
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "hotel_weather",
                  "columns:": [
                    "name",
                    "avg_tmpr_c",
                    "wthr_year",
                    "wthr_month"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 1549363 Data size: 54443410 Basic stats: COMPLETE Column stats: NONE",
                  "table:": "hotel_weather",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Select Operator": {
                      "expressions:": "name (type: string), avg_tmpr_c (type: double), wthr_year (type: int), wthr_month (type: int)",
                      "columnExprMap:": {
                        "BLOCK__OFFSET__INSIDE__FILE": "BLOCK__OFFSET__INSIDE__FILE",
                        "INPUT__FILE__NAME": "INPUT__FILE__NAME",
                        "ROW__ID": "ROW__ID",
                        "avg_tmpr_c": "avg_tmpr_c",
                        "hotelid": "hotelid",
                        "month": "month",
                        "name": "name",
                        "wthr_month": "wthr_month",
                        "wthr_year": "wthr_year",
                        "year": "year"
                      },
                      "outputColumnNames:": [
                        "name",
                        "avg_tmpr_c",
                        "wthr_year",
                        "wthr_month"
                      ],
                      "Statistics:": "Num rows: 1549363 Data size: 54443410 Basic stats: COMPLETE Column stats: NONE",
                      "OperatorId:": "SEL_16",
                      "children": {
                        "Group By Operator": {
                          "aggregations:": [
                            "max(avg_tmpr_c)",
                            "min(avg_tmpr_c)"
                          ],
                          "columnExprMap:": {
                            "_col0": "name",
                            "_col1": "wthr_year",
                            "_col2": "wthr_month"
                          },
                          "keys:": "name (type: string), wthr_year (type: int), wthr_month (type: int)",
                          "mode:": "hash",
                          "outputColumnNames:": [
                            "_col0",
                            "_col1",
                            "_col2",
                            "_col3",
                            "_col4"
                          ],
                          "Statistics:": "Num rows: 1549363 Data size: 54443410 Basic stats: COMPLETE Column stats: NONE",
                          "OperatorId:": "GBY_17",
                          "children": {
                            "Reduce Output Operator": {
                              "columnExprMap:": {
                                "KEY._col0": "_col0",
                                "KEY._col1": "_col1",
                                "KEY._col2": "_col2",
                                "VALUE._col0": "_col3",
                                "VALUE._col1": "_col4"
                              },
                              "key expressions:": "_col0 (type: string), _col1 (type: int), _col2 (type: int)",
                              "sort order:": "+++",
                              "Map-reduce partition columns:": "_col0 (type: string), _col1 (type: int), _col2 (type: int)",
                              "Statistics:": "Num rows: 1549363 Data size: 54443410 Basic stats: COMPLETE Column stats: NONE",
                              "value expressions:": "_col3 (type: double), _col4 (type: double)",
                              "OperatorId:": "RS_18",
                              "outputname:": "Reducer 2",
                              "outputOperator:": [
                                "GBY_19"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized"
          },
          "Reducer 2": {
            "Execution mode:": "vectorized",
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "max(VALUE._col0)",
                  "min(VALUE._col1)"
                ],
                "columnExprMap:": {
                  "_col0": "KEY._col0",
                  "_col1": "KEY._col1",
                  "_col2": "KEY._col2"
                },
                "keys:": "KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: int)",
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0",
                  "_col1",
                  "_col2",
                  "_col3",
                  "_col4"
                ],
                "Statistics:": "Num rows: 774681 Data size: 27221687 Basic stats: COMPLETE Column stats: NONE",
                "OperatorId:": "GBY_19",
                "children": {
                  "Select Operator": {
                    "expressions:": "_col0 (type: string), _col1 (type: int), _col2 (type: int), round(abs((_col3 - _col4)), 2) (type: double)",
                    "columnExprMap:": {
                      "_col0": "_col0",
                      "_col1": "_col1",
                      "_col2": "_col2",
                      "_col3": "round(abs((_col3 - _col4)), 2)"
                    },
                    "outputColumnNames:": [
                      "_col0",
                      "_col1",
                      "_col2",
                      "_col3"
                    ],
                    "Statistics:": "Num rows: 774681 Data size: 27221687 Basic stats: COMPLETE Column stats: NONE",
                    "OperatorId:": "SEL_20",
                    "children": {
                      "Group By Operator": {
                        "aggregations:": [
                          "max(_col3)"
                        ],
                        "columnExprMap:": {
                          "_col0": "_col0",
                          "_col1": "_col1",
                          "_col2": "_col2"
                        },
                        "keys:": "_col0 (type: string), _col1 (type: int), _col2 (type: int)",
                        "mode:": "complete",
                        "outputColumnNames:": [
                          "_col0",
                          "_col1",
                          "_col2",
                          "_col3"
                        ],
                        "Statistics:": "Num rows: 387340 Data size: 13610825 Basic stats: COMPLETE Column stats: NONE",
                        "OperatorId:": "GBY_21",
                        "children": {
                          "Select Operator": {
                            "expressions:": "_col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: double)",
                            "columnExprMap:": {
                              "_col0": "_col0",
                              "_col1": "_col1",
                              "_col2": "_col2",
                              "_col3": "_col3",
                              "_col4": "_col3"
                            },
                            "outputColumnNames:": [
                              "_col0",
                              "_col1",
                              "_col2",
                              "_col4"
                            ],
                            "Statistics:": "Num rows: 387340 Data size: 13610825 Basic stats: COMPLETE Column stats: NONE",
                            "OperatorId:": "SEL_22",
                            "children": {
                              "Reduce Output Operator": {
                                "columnExprMap:": {
                                  "KEY.reducesinkkey0": "_col4",
                                  "VALUE._col0": "_col0",
                                  "VALUE._col1": "_col1",
                                  "VALUE._col2": "_col2"
                                },
                                "key expressions:": "_col4 (type: double)",
                                "sort order:": "-",
                                "Statistics:": "Num rows: 387340 Data size: 13610825 Basic stats: COMPLETE Column stats: NONE",
                                "TopN Hash Memory Usage:": "0.04",
                                "value expressions:": "_col0 (type: string), _col1 (type: int), _col2 (type: int)",
                                "OperatorId:": "RS_23",
                                "outputname:": "Reducer 3",
                                "outputOperator:": [
                                  "SEL_24"
                                ]
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "Reducer 3": {
            "Execution mode:": "vectorized",
            "Reduce Operator Tree:": {
              "Select Operator": {
                "expressions:": "VALUE._col0 (type: string), VALUE._col1 (type: int), VALUE._col2 (type: int), KEY.reducesinkkey0 (type: double)",
                "columnExprMap:": {
                  "_col0": "VALUE._col0",
                  "_col1": "VALUE._col1",
                  "_col2": "VALUE._col2",
                  "_col3": "KEY.reducesinkkey0",
                  "_col4": "KEY.reducesinkkey0"
                },
                "outputColumnNames:": [
                  "_col0",
                  "_col1",
                  "_col2",
                  "_col3"
                ],
                "Statistics:": "Num rows: 387340 Data size: 13610825 Basic stats: COMPLETE Column stats: NONE",
                "OperatorId:": "SEL_24",
                "children": {
                  "Limit": {
                    "Number of rows:": "10",
                    "Statistics:": "Num rows: 10 Data size: 350 Basic stats: COMPLETE Column stats: NONE",
                    "OperatorId:": "LIM_25",
                    "children": {
                      "File Output Operator": {
                        "compressed:": "false",
                        "Statistics:": "Num rows: 10 Data size: 350 Basic stats: COMPLETE Column stats: NONE",
                        "table:": {
                          "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                          "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                          "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                        },
                        "OperatorId:": "FS_26"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_27"
          }
        }
      }
    }
  }
}