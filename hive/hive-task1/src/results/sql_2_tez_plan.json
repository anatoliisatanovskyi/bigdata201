{  
   "optimizedSQL":"SELECT `hotel_id`, `year`, `month`, `cnt` AS `visit_count`\nFROM (SELECT `hotel_id`, `year`, `month`, COUNT(*) AS `cnt`, DENSE_RANK() OVER (PARTITION BY `year`, `month` ORDER BY COUNT(*) DESC ROWS BETWEEN 2147483647 FOLLOWING AND 2147483647 PRECEDING) AS `_o__col5`\nFROM `default`.`hotel_visit`\nGROUP BY `hotel_id`, `year`, `month`) AS `t0`\nWHERE `_o__col5` <= 10\nLIMIT 10",
   "STAGE DEPENDENCIES":{  
      "Stage-1":{  
         "ROOT STAGE":"TRUE"
      },
      "Stage-0":{  
         "DEPENDENT STAGES":"Stage-1"
      }
   },
   "STAGE PLANS":{  
      "Stage-1":{  
         "Tez":{  
            "DagId:":"hive_20191210111133_605e9e63-80a7-4396-840b-f5a69f9a35ec:42",
            "Edges:":{  
               "Reducer 2":{  
                  "parent":"Map 1",
                  "type":"SIMPLE_EDGE"
               },
               "Reducer 3":{  
                  "parent":"Reducer 2",
                  "type":"SIMPLE_EDGE"
               }
            },
            "DagName:":"hive_20191210111133_605e9e63-80a7-4396-840b-f5a69f9a35ec:42",
            "Vertices:":{  
               "Map 1":{  
                  "Map Operator Tree:":[  
                     {  
                        "TableScan":{  
                           "alias:":"hotel_visit",
                           "columns:":[  
                              "hotel_id",
                              "year",
                              "month"
                           ],
                           "database:":"default",
                           "Statistics:":"Num rows: 2718261 Data size: 43492176 Basic stats: COMPLETE Column stats: NONE",
                           "table:":"hotel_visit",
                           "isTempTable:":"true",
                           "OperatorId:":"TS_0",
                           "children":{  
                              "Select Operator":{  
                                 "expressions:":"hotel_id (type: bigint), year (type: int), month (type: int)",
                                 "columnExprMap:":{  
                                    "BLOCK__OFFSET__INSIDE__FILE":"BLOCK__OFFSET__INSIDE__FILE",
                                    "INPUT__FILE__NAME":"INPUT__FILE__NAME",
                                    "ROW__ID":"ROW__ID",
                                    "hotel_id":"hotel_id",
                                    "month":"month",
                                    "year":"year"
                                 },
                                 "outputColumnNames:":[  
                                    "hotel_id",
                                    "year",
                                    "month"
                                 ],
                                 "Statistics:":"Num rows: 2718261 Data size: 43492176 Basic stats: COMPLETE Column stats: NONE",
                                 "OperatorId:":"SEL_16",
                                 "children":{  
                                    "Group By Operator":{  
                                       "aggregations:":[  
                                          "count()"
                                       ],
                                       "columnExprMap:":{  
                                          "_col0":"hotel_id",
                                          "_col1":"year",
                                          "_col2":"month"
                                       },
                                       "keys:":"hotel_id (type: bigint), year (type: int), month (type: int)",
                                       "mode:":"hash",
                                       "outputColumnNames:":[  
                                          "_col0",
                                          "_col1",
                                          "_col2",
                                          "_col3"
                                       ],
                                       "Statistics:":"Num rows: 2718261 Data size: 43492176 Basic stats: COMPLETE Column stats: NONE",
                                       "OperatorId:":"GBY_17",
                                       "children":{  
                                          "Reduce Output Operator":{  
                                             "columnExprMap:":{  
                                                "KEY._col0":"_col0",
                                                "KEY._col1":"_col1",
                                                "KEY._col2":"_col2",
                                                "VALUE._col0":"_col3"
                                             },
                                             "key expressions:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                             "sort order:":"+++",
                                             "Map-reduce partition columns:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                             "Statistics:":"Num rows: 2718261 Data size: 43492176 Basic stats: COMPLETE Column stats: NONE",
                                             "value expressions:":"_col3 (type: bigint)",
                                             "OperatorId:":"RS_18",
                                             "outputname:":"Reducer 2",
                                             "outputOperator:":[  
                                                "GBY_19"
                                             ]
                                          }
                                       }
                                    }
                                 }
                              }
                           }
                        }
                     }
                  ],
                  "Execution mode:":"vectorized"
               },
               "Reducer 2":{  
                  "Execution mode:":"vectorized",
                  "Reduce Operator Tree:":{  
                     "Group By Operator":{  
                        "aggregations:":[  
                           "count(VALUE._col0)"
                        ],
                        "columnExprMap:":{  
                           "_col0":"KEY._col0",
                           "_col1":"KEY._col1",
                           "_col2":"KEY._col2"
                        },
                        "keys:":"KEY._col0 (type: bigint), KEY._col1 (type: int), KEY._col2 (type: int)",
                        "mode:":"mergepartial",
                        "outputColumnNames:":[  
                           "_col0",
                           "_col1",
                           "_col2",
                           "_col3"
                        ],
                        "Statistics:":"Num rows: 1359130 Data size: 21746080 Basic stats: COMPLETE Column stats: NONE",
                        "OperatorId:":"GBY_19",
                        "children":{  
                           "Reduce Output Operator":{  
                              "columnExprMap:":{  
                                 "KEY.reducesinkkey0":"_col1",
                                 "KEY.reducesinkkey1":"_col2",
                                 "KEY.reducesinkkey2":"_col3",
                                 "VALUE._col0":"_col0"
                              },
                              "key expressions:":"_col1 (type: int), _col2 (type: int), _col3 (type: bigint)",
                              "sort order:":"++-",
                              "Map-reduce partition columns:":"_col1 (type: int), _col2 (type: int)",
                              "Statistics:":"Num rows: 1359130 Data size: 21746080 Basic stats: COMPLETE Column stats: NONE",
                              "TopN Hash Memory Usage:":"0.04",
                              "value expressions:":"_col0 (type: bigint)",
                              "OperatorId:":"RS_20",
                              "outputname:":"Reducer 3",
                              "outputOperator:":[  
                                 "SEL_7"
                              ]
                           }
                        }
                     }
                  }
               },
               "Reducer 3":{  
                  "Reduce Operator Tree:":{  
                     "Select Operator":{  
                        "expressions:":"VALUE._col0 (type: bigint), KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: bigint)",
                        "columnExprMap:":{  
                           "_col0":"VALUE._col0",
                           "_col1":"KEY.reducesinkkey0",
                           "_col2":"KEY.reducesinkkey1",
                           "_col3":"KEY.reducesinkkey2"
                        },
                        "outputColumnNames:":[  
                           "_col0",
                           "_col1",
                           "_col2",
                           "_col3"
                        ],
                        "Statistics:":"Num rows: 1359130 Data size: 21746080 Basic stats: COMPLETE Column stats: NONE",
                        "OperatorId:":"SEL_7",
                        "children":{  
                           "PTF Operator":{  
                              "Function definitions:":[  
                                 {  
                                    "Input definition":{  
                                       "input alias:":"ptf_0",
                                       "output shape:":"_col0: bigint, _col1: int, _col2: int, _col3: bigint",
                                       "type:":"WINDOWING"
                                    }
                                 },
                                 {  
                                    "Windowing table definition":{  
                                       "input alias:":"ptf_1",
                                       "name:":"windowingtablefunction",
                                       "order by:":"_col3 DESC NULLS LAST",
                                       "partition by:":"_col1, _col2",
                                       "window functions:":[  
                                          {  
                                             "window function definition":{  
                                                "alias:":"Dense_rank_window_0",
                                                "arguments:":"_col3",
                                                "name:":"Dense_rank",
                                                "window function:":"GenericUDAFDenseRankEvaluator",
                                                "window frame:":"ROWS PRECEDING(MAX)~FOLLOWING(MAX)",
                                                "isPivotResult:":"true"
                                             }
                                          }
                                       ]
                                    }
                                 }
                              ],
                              "Statistics:":"Num rows: 1359130 Data size: 21746080 Basic stats: COMPLETE Column stats: NONE",
                              "OperatorId:":"PTF_8",
                              "children":{  
                                 "Filter Operator":{  
                                    "predicate:":"(Dense_rank_window_0 <= 10) (type: boolean)",
                                    "Statistics:":"Num rows: 453043 Data size: 7248688 Basic stats: COMPLETE Column stats: NONE",
                                    "OperatorId:":"FIL_15",
                                    "children":{  
                                       "Select Operator":{  
                                          "expressions:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: int), _col3 (type: bigint)",
                                          "columnExprMap:":{  
                                             "_col0":"_col0",
                                             "_col1":"_col1",
                                             "_col2":"_col2",
                                             "_col3":"_col3"
                                          },
                                          "outputColumnNames:":[  
                                             "_col0",
                                             "_col1",
                                             "_col2",
                                             "_col3"
                                          ],
                                          "Statistics:":"Num rows: 453043 Data size: 7248688 Basic stats: COMPLETE Column stats: NONE",
                                          "OperatorId:":"SEL_9",
                                          "children":{  
                                             "Limit":{  
                                                "Number of rows:":"10",
                                                "Statistics:":"Num rows: 10 Data size: 160 Basic stats: COMPLETE Column stats: NONE",
                                                "OperatorId:":"LIM_13",
                                                "children":{  
                                                   "File Output Operator":{  
                                                      "compressed:":"false",
                                                      "Statistics:":"Num rows: 10 Data size: 160 Basic stats: COMPLETE Column stats: NONE",
                                                      "table:":{  
                                                         "input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat",
                                                         "output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                                                         "serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                                                      },
                                                      "OperatorId:":"FS_14"
                                                   }
                                                }
                                             }
                                          }
                                       }
                                    }
                                 }
                              }
                           }
                        }
                     }
                  }
               }
            }
         }
      },
      "Stage-0":{  
         "Fetch Operator":{  
            "limit:":"10",
            "Processor Tree:":{  
               "ListSink":{  
                  "OperatorId:":"LIST_SINK_22"
               }
            }
         }
      }
   }
}