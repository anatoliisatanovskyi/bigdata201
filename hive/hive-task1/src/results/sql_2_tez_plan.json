{
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
        "DagId:": "hive_20191204104350_c2fcbb9f-80ca-4bae-a1f6-716ed3abdf54:49",
        "Edges:": {
          "Reducer 2": {
            "parent": "Map 1",
            "type": "SIMPLE_EDGE"
          },
          "Reducer 3": {
            "parent": "Reducer 2",
            "type": "SIMPLE_EDGE"
          }
        },
        "DagName:": "hive_20191204104350_c2fcbb9f-80ca-4bae-a1f6-716ed3abdf54:49",
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "t",
                  "columns:": [
                    "srch_ci",
                    "hotel_id",
                    "srch_co"
                  ],
                  "database:": "default",
                  "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                  "table:": "hdfs_expedia",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Lateral View Forward": {
                      "columnExprMap:": {
                        "BLOCK__OFFSET__INSIDE__FILE": "BLOCK__OFFSET__INSIDE__FILE",
                        "INPUT__FILE__NAME": "INPUT__FILE__NAME",
                        "ROW__ID": "ROW__ID",
                        "channel": "channel",
                        "date_time": "date_time",
                        "hotel_id": "hotel_id",
                        "id": "id",
                        "is_mobile": "is_mobile",
                        "is_package": "is_package",
                        "orig_destination_distance": "orig_destination_distance",
                        "posa_continent": "posa_continent",
                        "site_name": "site_name",
                        "srch_adults_cnt": "srch_adults_cnt",
                        "srch_children_cnt": "srch_children_cnt",
                        "srch_ci": "srch_ci",
                        "srch_co": "srch_co",
                        "srch_destination_id": "srch_destination_id",
                        "srch_destination_type_id": "srch_destination_type_id",
                        "srch_rm_cnt": "srch_rm_cnt",
                        "user_id": "user_id",
                        "user_location_city": "user_location_city",
                        "user_location_country": "user_location_country",
                        "user_location_region": "user_location_region"
                      },
                      "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                      "OperatorId:": "LVF_1",
                      "children": [
                        {
                          "Select Operator": {
                            "expressions:": "srch_ci (type: string), hotel_id (type: bigint)",
                            "columnExprMap:": {
                              "BLOCK__OFFSET__INSIDE__FILE": "BLOCK__OFFSET__INSIDE__FILE",
                              "INPUT__FILE__NAME": "INPUT__FILE__NAME",
                              "ROW__ID": "ROW__ID",
                              "channel": "channel",
                              "date_time": "date_time",
                              "hotel_id": "hotel_id",
                              "id": "id",
                              "is_mobile": "is_mobile",
                              "is_package": "is_package",
                              "org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc": "ROW__ID",
                              "orig_destination_distance": "orig_destination_distance",
                              "posa_continent": "posa_continent",
                              "site_name": "site_name",
                              "srch_adults_cnt": "srch_adults_cnt",
                              "srch_children_cnt": "srch_children_cnt",
                              "srch_ci": "srch_ci",
                              "srch_co": "srch_co",
                              "srch_destination_id": "srch_destination_id",
                              "srch_destination_type_id": "srch_destination_type_id",
                              "srch_rm_cnt": "srch_rm_cnt",
                              "user_id": "user_id",
                              "user_location_city": "user_location_city",
                              "user_location_country": "user_location_country",
                              "user_location_region": "user_location_region"
                            },
                            "outputColumnNames:": [
                              "srch_ci",
                              "hotel_id"
                            ],
                            "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                            "OperatorId:": "SEL_2",
                            "children": {
                              "Lateral View Join Operator": {
                                "columnExprMap:": {
                                  "_col0": "id",
                                  "_col1": "date_time",
                                  "_col10": "is_package",
                                  "_col11": "channel",
                                  "_col12": "srch_ci",
                                  "_col13": "srch_co",
                                  "_col14": "srch_adults_cnt",
                                  "_col15": "srch_children_cnt",
                                  "_col16": "srch_rm_cnt",
                                  "_col17": "srch_destination_id",
                                  "_col18": "srch_destination_type_id",
                                  "_col19": "hotel_id",
                                  "_col2": "site_name",
                                  "_col20": "BLOCK__OFFSET__INSIDE__FILE",
                                  "_col21": "INPUT__FILE__NAME",
                                  "_col22": "ROW__ID",
                                  "_col23": "pos",
                                  "_col24": "val",
                                  "_col3": "posa_continent",
                                  "_col4": "user_location_country",
                                  "_col5": "user_location_region",
                                  "_col6": "user_location_city",
                                  "_col7": "orig_destination_distance",
                                  "_col8": "user_id",
                                  "_col9": "is_mobile"
                                },
                                "outputColumnNames:": [
                                  "_col12",
                                  "_col19",
                                  "_col23",
                                  "_col24"
                                ],
                                "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                "OperatorId:": "LVJ_5",
                                "children": {
                                  "Select Operator": {
                                    "expressions:": "_col19 (type: bigint), year(add_months(_col12, _col23)) (type: int), month(add_months(_col12, _col23)) (type: int)",
                                    "columnExprMap:": {
                                      "_col0": "_col19",
                                      "_col1": "year(add_months(_col12, _col23))",
                                      "_col2": "month(add_months(_col12, _col23))"
                                    },
                                    "outputColumnNames:": [
                                      "_col0",
                                      "_col1",
                                      "_col2"
                                    ],
                                    "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                    "OperatorId:": "SEL_6",
                                    "children": {
                                      "Group By Operator": {
                                        "aggregations:": [
                                          "count()"
                                        ],
                                        "columnExprMap:": {
                                          "_col0": "_col0",
                                          "_col1": "_col1",
                                          "_col2": "_col2"
                                        },
                                        "keys:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                        "mode:": "hash",
                                        "outputColumnNames:": [
                                          "_col0",
                                          "_col1",
                                          "_col2",
                                          "_col3"
                                        ],
                                        "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                        "OperatorId:": "GBY_8",
                                        "children": {
                                          "Reduce Output Operator": {
                                            "columnExprMap:": {
                                              "KEY._col0": "_col0",
                                              "KEY._col1": "_col1",
                                              "KEY._col2": "_col2",
                                              "VALUE._col0": "_col3"
                                            },
                                            "key expressions:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                            "sort order:": "+++",
                                            "Map-reduce partition columns:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                            "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                            "value expressions:": "_col3 (type: bigint)",
                                            "OperatorId:": "RS_9",
                                            "outputname:": "Reducer 2",
                                            "outputOperator:": [
                                              "GBY_16"
                                            ]
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        },
                        {
                          "Select Operator": {
                            "expressions:": "split(space((((year(srch_co) - year(srch_ci)) * 12) + (month(srch_co) - month(srch_ci)))), ' ') (type: array<string>)",
                            "columnExprMap:": {
                              "_col0": "split(space((((year(srch_co) - year(srch_ci)) * 12) + (month(srch_co) - month(srch_ci)))), ' ')"
                            },
                            "outputColumnNames:": [
                              "_col0"
                            ],
                            "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                            "OperatorId:": "SEL_3",
                            "children": {
                              "UDTF Operator": {
                                "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                                "function name:": "posexplode",
                                "OperatorId:": "UDTF_4",
                                "children": {
                                  "Lateral View Join Operator": {
                                    "columnExprMap:": {
                                      "_col0": "id",
                                      "_col1": "date_time",
                                      "_col10": "is_package",
                                      "_col11": "channel",
                                      "_col12": "srch_ci",
                                      "_col13": "srch_co",
                                      "_col14": "srch_adults_cnt",
                                      "_col15": "srch_children_cnt",
                                      "_col16": "srch_rm_cnt",
                                      "_col17": "srch_destination_id",
                                      "_col18": "srch_destination_type_id",
                                      "_col19": "hotel_id",
                                      "_col2": "site_name",
                                      "_col20": "BLOCK__OFFSET__INSIDE__FILE",
                                      "_col21": "INPUT__FILE__NAME",
                                      "_col22": "ROW__ID",
                                      "_col23": "pos",
                                      "_col24": "val",
                                      "_col3": "posa_continent",
                                      "_col4": "user_location_country",
                                      "_col5": "user_location_region",
                                      "_col6": "user_location_city",
                                      "_col7": "orig_destination_distance",
                                      "_col8": "user_id",
                                      "_col9": "is_mobile"
                                    },
                                    "outputColumnNames:": [
                                      "_col12",
                                      "_col19",
                                      "_col23",
                                      "_col24"
                                    ],
                                    "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                    "OperatorId:": "LVJ_5",
                                    "children": {
                                      "Select Operator": {
                                        "expressions:": "_col19 (type: bigint), year(add_months(_col12, _col23)) (type: int), month(add_months(_col12, _col23)) (type: int)",
                                        "columnExprMap:": {
                                          "_col0": "_col19",
                                          "_col1": "year(add_months(_col12, _col23))",
                                          "_col2": "month(add_months(_col12, _col23))"
                                        },
                                        "outputColumnNames:": [
                                          "_col0",
                                          "_col1",
                                          "_col2"
                                        ],
                                        "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                        "OperatorId:": "SEL_6",
                                        "children": {
                                          "Group By Operator": {
                                            "aggregations:": [
                                              "count()"
                                            ],
                                            "columnExprMap:": {
                                              "_col0": "_col0",
                                              "_col1": "_col1",
                                              "_col2": "_col2"
                                            },
                                            "keys:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                            "mode:": "hash",
                                            "outputColumnNames:": [
                                              "_col0",
                                              "_col1",
                                              "_col2",
                                              "_col3"
                                            ],
                                            "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                            "OperatorId:": "GBY_8",
                                            "children": {
                                              "Reduce Output Operator": {
                                                "columnExprMap:": {
                                                  "KEY._col0": "_col0",
                                                  "KEY._col1": "_col1",
                                                  "KEY._col2": "_col2",
                                                  "VALUE._col0": "_col3"
                                                },
                                                "key expressions:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                                "sort order:": "+++",
                                                "Map-reduce partition columns:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                                                "Statistics:": "Num rows: 4893126 Data size: 2759723520 Basic stats: COMPLETE Column stats: NONE",
                                                "value expressions:": "_col3 (type: bigint)",
                                                "OperatorId:": "RS_9",
                                                "outputname:": "Reducer 2",
                                                "outputOperator:": [
                                                  "GBY_16"
                                                ]
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                }
              }
            ]
          },
          "Reducer 2": {
            "Execution mode:": "vectorized",
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "count(VALUE._col0)"
                ],
                "columnExprMap:": {
                  "_col0": "KEY._col0",
                  "_col1": "KEY._col1",
                  "_col2": "KEY._col2"
                },
                "keys:": "KEY._col0 (type: bigint), KEY._col1 (type: int), KEY._col2 (type: int)",
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0",
                  "_col1",
                  "_col2",
                  "_col3"
                ],
                "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                "OperatorId:": "GBY_16",
                "children": {
                  "Reduce Output Operator": {
                    "columnExprMap:": {
                      "KEY.reducesinkkey0": "_col3",
                      "VALUE._col0": "_col0",
                      "VALUE._col1": "_col1",
                      "VALUE._col2": "_col2"
                    },
                    "key expressions:": "_col3 (type: bigint)",
                    "sort order:": "-",
                    "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                    "TopN Hash Memory Usage:": "0.04",
                    "value expressions:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: int)",
                    "OperatorId:": "RS_17",
                    "outputname:": "Reducer 3",
                    "outputOperator:": [
                      "SEL_18"
                    ]
                  }
                }
              }
            }
          },
          "Reducer 3": {
            "Execution mode:": "vectorized",
            "Reduce Operator Tree:": {
              "Select Operator": {
                "expressions:": "VALUE._col0 (type: bigint), VALUE._col1 (type: int), VALUE._col2 (type: int), KEY.reducesinkkey0 (type: bigint)",
                "columnExprMap:": {
                  "_col0": "VALUE._col0",
                  "_col1": "VALUE._col1",
                  "_col2": "VALUE._col2",
                  "_col3": "KEY.reducesinkkey0"
                },
                "outputColumnNames:": [
                  "_col0",
                  "_col1",
                  "_col2",
                  "_col3"
                ],
                "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                "OperatorId:": "SEL_18",
                "children": {
                  "Limit": {
                    "Number of rows:": "10",
                    "Statistics:": "Num rows: 10 Data size: 5640 Basic stats: COMPLETE Column stats: NONE",
                    "OperatorId:": "LIM_19",
                    "children": {
                      "File Output Operator": {
                        "compressed:": "false",
                        "Statistics:": "Num rows: 10 Data size: 5640 Basic stats: COMPLETE Column stats: NONE",
                        "table:": {
                          "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                          "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                          "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                        },
                        "OperatorId:": "FS_20"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "10",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_21"
          }
        }
      }
    }
  }
}