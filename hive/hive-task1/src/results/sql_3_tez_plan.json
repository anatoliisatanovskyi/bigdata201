{
  "STAGE DEPENDENCIES": {
    "Stage-1": {
      "ROOT STAGE": "TRUE"
    },
    "Stage-0": {
      "DEPENDENT STAGES": "Stage-1"
    }
  },
  "STAGE PLANS": {
    "Stage-1": {
      "Tez": {
        "DagId:": "hive_20191204135111_b771a92f-962f-499c-88bf-7fac7d4c8586:86",
        "Edges:": {
          "Map 1": {
            "parent": "Map 7",
            "type": "BROADCAST_EDGE"
          },
          "Map 4": [
            {
              "parent": "Map 5",
              "type": "BROADCAST_EDGE"
            },
            {
              "parent": "Map 6",
              "type": "BROADCAST_EDGE"
            }
          ],
          "Reducer 2": [
            {
              "parent": "Map 1",
              "type": "CUSTOM_SIMPLE_EDGE"
            },
            {
              "parent": "Map 4",
              "type": "CUSTOM_SIMPLE_EDGE"
            }
          ],
          "Reducer 3": {
            "parent": "Reducer 2",
            "type": "SIMPLE_EDGE"
          }
        },
        "DagName:": "hive_20191204135111_b771a92f-962f-499c-88bf-7fac7d4c8586:86",
        "Vertices:": {
          "Map 1": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "t",
                  "columns:": [
                    "id",
                    "user_id",
                    "srch_ci",
                    "srch_co",
                    "hotel_id"
                  ],
                  "database:": "default",
                  "filterExpr:": "((datediff(to_date(srch_co), to_date(srch_ci)) > 7) and UDFToDouble(hotel_id) is not null and id is not null) (type: boolean)",
                  "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                  "table:": "hdfs_expedia",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_0",
                  "children": {
                    "Filter Operator": {
                      "predicate:": "((datediff(to_date(srch_co), to_date(srch_ci)) > 7) and UDFToDouble(hotel_id) is not null and id is not null) (type: boolean)",
                      "Statistics:": "Num rows: 815521 Data size: 459953920 Basic stats: COMPLETE Column stats: NONE",
                      "OperatorId:": "FIL_54",
                      "children": {
                        "Lateral View Forward": {
                          "columnExprMap:": {
                            "BLOCK__OFFSET__INSIDE__FILE": "BLOCK__OFFSET__INSIDE__FILE",
                            "INPUT__FILE__NAME": "INPUT__FILE__NAME",
                            "ROW__ID": "ROW__ID",
                            "channel": "channel",
                            "date_time": "date_time",
                            "hotel_id": "hotel_id",
                            "id": "id",
                            "is_mobile": "is_mobile",
                            "is_package": "is_package",
                            "orig_destination_distance": "orig_destination_distance",
                            "posa_continent": "posa_continent",
                            "site_name": "site_name",
                            "srch_adults_cnt": "srch_adults_cnt",
                            "srch_children_cnt": "srch_children_cnt",
                            "srch_ci": "srch_ci",
                            "srch_co": "srch_co",
                            "srch_destination_id": "srch_destination_id",
                            "srch_destination_type_id": "srch_destination_type_id",
                            "srch_rm_cnt": "srch_rm_cnt",
                            "user_id": "user_id",
                            "user_location_city": "user_location_city",
                            "user_location_country": "user_location_country",
                            "user_location_region": "user_location_region"
                          },
                          "Statistics:": "Num rows: 815521 Data size: 459953920 Basic stats: COMPLETE Column stats: NONE",
                          "OperatorId:": "LVF_1",
                          "children": [
                            {
                              "Select Operator": {
                                "expressions:": "id (type: bigint), user_id (type: int), srch_ci (type: string), hotel_id (type: bigint)",
                                "columnExprMap:": {
                                  "BLOCK__OFFSET__INSIDE__FILE": "BLOCK__OFFSET__INSIDE__FILE",
                                  "INPUT__FILE__NAME": "INPUT__FILE__NAME",
                                  "ROW__ID": "ROW__ID",
                                  "channel": "channel",
                                  "date_time": "date_time",
                                  "hotel_id": "hotel_id",
                                  "id": "id",
                                  "is_mobile": "is_mobile",
                                  "is_package": "is_package",
                                  "org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc": "ROW__ID",
                                  "orig_destination_distance": "orig_destination_distance",
                                  "posa_continent": "posa_continent",
                                  "site_name": "site_name",
                                  "srch_adults_cnt": "srch_adults_cnt",
                                  "srch_children_cnt": "srch_children_cnt",
                                  "srch_ci": "srch_ci",
                                  "srch_co": "srch_co",
                                  "srch_destination_id": "srch_destination_id",
                                  "srch_destination_type_id": "srch_destination_type_id",
                                  "srch_rm_cnt": "srch_rm_cnt",
                                  "user_id": "user_id",
                                  "user_location_city": "user_location_city",
                                  "user_location_country": "user_location_country",
                                  "user_location_region": "user_location_region"
                                },
                                "outputColumnNames:": [
                                  "id",
                                  "user_id",
                                  "srch_ci",
                                  "hotel_id"
                                ],
                                "Statistics:": "Num rows: 815521 Data size: 459953920 Basic stats: COMPLETE Column stats: NONE",
                                "OperatorId:": "SEL_2",
                                "children": {
                                  "Lateral View Join Operator": {
                                    "columnExprMap:": {
                                      "_col0": "id",
                                      "_col1": "date_time",
                                      "_col10": "is_package",
                                      "_col11": "channel",
                                      "_col12": "srch_ci",
                                      "_col13": "srch_co",
                                      "_col14": "srch_adults_cnt",
                                      "_col15": "srch_children_cnt",
                                      "_col16": "srch_rm_cnt",
                                      "_col17": "srch_destination_id",
                                      "_col18": "srch_destination_type_id",
                                      "_col19": "hotel_id",
                                      "_col2": "site_name",
                                      "_col20": "BLOCK__OFFSET__INSIDE__FILE",
                                      "_col21": "INPUT__FILE__NAME",
                                      "_col22": "ROW__ID",
                                      "_col23": "pos",
                                      "_col24": "val",
                                      "_col3": "posa_continent",
                                      "_col4": "user_location_country",
                                      "_col5": "user_location_region",
                                      "_col6": "user_location_city",
                                      "_col7": "orig_destination_distance",
                                      "_col8": "user_id",
                                      "_col9": "is_mobile"
                                    },
                                    "outputColumnNames:": [
                                      "_col0",
                                      "_col8",
                                      "_col12",
                                      "_col19",
                                      "_col23",
                                      "_col24"
                                    ],
                                    "Statistics:": "Num rows: 1631042 Data size: 919907840 Basic stats: COMPLETE Column stats: NONE",
                                    "OperatorId:": "LVJ_5",
                                    "children": {
                                      "Select Operator": {
                                        "expressions:": "_col0 (type: bigint), _col8 (type: int), _col19 (type: bigint), date_add(_col12, _col23) (type: date)",
                                        "columnExprMap:": {
                                          "_col0": "_col0",
                                          "_col1": "_col8",
                                          "_col2": "_col19",
                                          "_col3": "date_add(_col12, _col23)"
                                        },
                                        "outputColumnNames:": [
                                          "_col0",
                                          "_col1",
                                          "_col2",
                                          "_col3"
                                        ],
                                        "Statistics:": "Num rows: 1631042 Data size: 919907840 Basic stats: COMPLETE Column stats: NONE",
                                        "OperatorId:": "SEL_7",
                                        "children": {
                                          "Filter Operator": {
                                            "predicate:": "_col3 is not null (type: boolean)",
                                            "Statistics:": "Num rows: 1631042 Data size: 919907840 Basic stats: COMPLETE Column stats: NONE",
                                            "OperatorId:": "FIL_53",
                                            "children": {
                                              "Map Join Operator": {
                                                "columnExprMap:": {
                                                  "_col0": "0:_col0",
                                                  "_col1": "0:_col1",
                                                  "_col10": "1:avg_tmpr_c",
                                                  "_col2": "0:_col2"
                                                },
                                                "condition map:": [
                                                  {
                                                    "": "Inner Join 0 to 1"
                                                  }
                                                ],
                                                "keys:": {
                                                  "0": "UDFToDouble(_col2) (type: double), _col3 (type: date)",
                                                  "1": "UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)"
                                                },
                                                "outputColumnNames:": [
                                                  "_col0",
                                                  "_col1",
                                                  "_col2",
                                                  "_col10"
                                                ],
                                                "input vertices:": {
                                                  "1": "Map 7"
                                                },
                                                "Statistics:": "Num rows: 1794146 Data size: 1011898645 Basic stats: PARTIAL Column stats: NONE",
                                                "HybridGraceHashJoin:": "true",
                                                "OperatorId:": "MAPJOIN_66",
                                                "children": {
                                                  "Reduce Output Operator": {
                                                    "columnExprMap:": {
                                                      "KEY.reducesinkkey0": "_col0",
                                                      "VALUE._col0": "_col1",
                                                      "VALUE._col1": "_col2",
                                                      "VALUE._col9": "_col10"
                                                    },
                                                    "key expressions:": "_col0 (type: bigint)",
                                                    "sort order:": "+",
                                                    "Map-reduce partition columns:": "_col0 (type: bigint)",
                                                    "Statistics:": "Num rows: 1794146 Data size: 1011898645 Basic stats: PARTIAL Column stats: NONE",
                                                    "value expressions:": "_col1 (type: int), _col2 (type: bigint), _col10 (type: double)",
                                                    "OperatorId:": "RS_29",
                                                    "outputname:": "Reducer 2",
                                                    "outputOperator:": [
                                                      "MAPJOIN_84"
                                                    ]
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            },
                            {
                              "Select Operator": {
                                "expressions:": "split(space(datediff(srch_co, srch_ci)), ' ') (type: array<string>)",
                                "columnExprMap:": {
                                  "_col0": "split(space(datediff(srch_co, srch_ci)), ' ')"
                                },
                                "outputColumnNames:": [
                                  "_col0"
                                ],
                                "Statistics:": "Num rows: 815521 Data size: 459953920 Basic stats: COMPLETE Column stats: NONE",
                                "OperatorId:": "SEL_3",
                                "children": {
                                  "UDTF Operator": {
                                    "Statistics:": "Num rows: 815521 Data size: 459953920 Basic stats: COMPLETE Column stats: NONE",
                                    "function name:": "posexplode",
                                    "OperatorId:": "UDTF_4",
                                    "children": {
                                      "Lateral View Join Operator": {
                                        "columnExprMap:": {
                                          "_col0": "id",
                                          "_col1": "date_time",
                                          "_col10": "is_package",
                                          "_col11": "channel",
                                          "_col12": "srch_ci",
                                          "_col13": "srch_co",
                                          "_col14": "srch_adults_cnt",
                                          "_col15": "srch_children_cnt",
                                          "_col16": "srch_rm_cnt",
                                          "_col17": "srch_destination_id",
                                          "_col18": "srch_destination_type_id",
                                          "_col19": "hotel_id",
                                          "_col2": "site_name",
                                          "_col20": "BLOCK__OFFSET__INSIDE__FILE",
                                          "_col21": "INPUT__FILE__NAME",
                                          "_col22": "ROW__ID",
                                          "_col23": "pos",
                                          "_col24": "val",
                                          "_col3": "posa_continent",
                                          "_col4": "user_location_country",
                                          "_col5": "user_location_region",
                                          "_col6": "user_location_city",
                                          "_col7": "orig_destination_distance",
                                          "_col8": "user_id",
                                          "_col9": "is_mobile"
                                        },
                                        "outputColumnNames:": [
                                          "_col0",
                                          "_col8",
                                          "_col12",
                                          "_col19",
                                          "_col23",
                                          "_col24"
                                        ],
                                        "Statistics:": "Num rows: 1631042 Data size: 919907840 Basic stats: COMPLETE Column stats: NONE",
                                        "OperatorId:": "LVJ_5",
                                        "children": {
                                          "Select Operator": {
                                            "expressions:": "_col0 (type: bigint), _col8 (type: int), _col19 (type: bigint), date_add(_col12, _col23) (type: date)",
                                            "columnExprMap:": {
                                              "_col0": "_col0",
                                              "_col1": "_col8",
                                              "_col2": "_col19",
                                              "_col3": "date_add(_col12, _col23)"
                                            },
                                            "outputColumnNames:": [
                                              "_col0",
                                              "_col1",
                                              "_col2",
                                              "_col3"
                                            ],
                                            "Statistics:": "Num rows: 1631042 Data size: 919907840 Basic stats: COMPLETE Column stats: NONE",
                                            "OperatorId:": "SEL_7",
                                            "children": {
                                              "Filter Operator": {
                                                "predicate:": "_col3 is not null (type: boolean)",
                                                "Statistics:": "Num rows: 1631042 Data size: 919907840 Basic stats: COMPLETE Column stats: NONE",
                                                "OperatorId:": "FIL_53",
                                                "children": {
                                                  "Map Join Operator": {
                                                    "columnExprMap:": {
                                                      "_col0": "0:_col0",
                                                      "_col1": "0:_col1",
                                                      "_col10": "1:avg_tmpr_c",
                                                      "_col2": "0:_col2"
                                                    },
                                                    "condition map:": [
                                                      {
                                                        "": "Inner Join 0 to 1"
                                                      }
                                                    ],
                                                    "keys:": {
                                                      "0": "UDFToDouble(_col2) (type: double), _col3 (type: date)",
                                                      "1": "UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)"
                                                    },
                                                    "outputColumnNames:": [
                                                      "_col0",
                                                      "_col1",
                                                      "_col2",
                                                      "_col10"
                                                    ],
                                                    "input vertices:": {
                                                      "1": "Map 7"
                                                    },
                                                    "Statistics:": "Num rows: 1794146 Data size: 1011898645 Basic stats: PARTIAL Column stats: NONE",
                                                    "HybridGraceHashJoin:": "true",
                                                    "OperatorId:": "MAPJOIN_66",
                                                    "children": {
                                                      "Reduce Output Operator": {
                                                        "columnExprMap:": {
                                                          "KEY.reducesinkkey0": "_col0",
                                                          "VALUE._col0": "_col1",
                                                          "VALUE._col1": "_col2",
                                                          "VALUE._col9": "_col10"
                                                        },
                                                        "key expressions:": "_col0 (type: bigint)",
                                                        "sort order:": "+",
                                                        "Map-reduce partition columns:": "_col0 (type: bigint)",
                                                        "Statistics:": "Num rows: 1794146 Data size: 1011898645 Basic stats: PARTIAL Column stats: NONE",
                                                        "value expressions:": "_col1 (type: int), _col2 (type: bigint), _col10 (type: double)",
                                                        "OperatorId:": "RS_29",
                                                        "outputname:": "Reducer 2",
                                                        "outputOperator:": [
                                                          "MAPJOIN_84"
                                                        ]
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  }
                }
              }
            ]
          },
          "Map 4": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "tt1",
                  "columns:": [
                    "id",
                    "srch_ci",
                    "srch_co",
                    "hotel_id"
                  ],
                  "database:": "default",
                  "filterExpr:": "(UDFToDouble(hotel_id) is not null and srch_co is not null and srch_ci is not null and id is not null) (type: boolean)",
                  "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                  "table:": "hdfs_expedia",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_8",
                  "children": {
                    "Filter Operator": {
                      "predicate:": "(UDFToDouble(hotel_id) is not null and srch_co is not null and srch_ci is not null and id is not null) (type: boolean)",
                      "Statistics:": "Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                      "OperatorId:": "FIL_79",
                      "children": {
                        "Map Join Operator": {
                          "columnExprMap:": {
                            "_col0": "0:id",
                            "_col12": "0:srch_ci",
                            "_col19": "0:hotel_id",
                            "_col25": "1:avg_tmpr"
                          },
                          "condition map:": [
                            {
                              "": "Inner Join 0 to 1"
                            }
                          ],
                          "keys:": {
                            "0": "UDFToDouble(hotel_id) (type: double), srch_co (type: string)",
                            "1": "UDFToDouble(hotelid) (type: double), wthr_date (type: string)"
                          },
                          "outputColumnNames:": [
                            "_col0",
                            "_col12",
                            "_col19",
                            "_col25"
                          ],
                          "input vertices:": {
                            "1": "Map 5"
                          },
                          "Statistics:": "Num rows: 2691219 Data size: 1517847968 Basic stats: COMPLETE Column stats: NONE",
                          "HybridGraceHashJoin:": "true",
                          "OperatorId:": "MAPJOIN_80",
                          "children": {
                            "Map Join Operator": {
                              "columnExprMap:": {
                                "_col0": "0:_col0",
                                "_col25": "0:_col25",
                                "_col34": "1:avg_tmpr"
                              },
                              "condition map:": [
                                {
                                  "": "Inner Join 0 to 1"
                                }
                              ],
                              "keys:": {
                                "0": "UDFToDouble(_col19) (type: double), _col12 (type: string)",
                                "1": "UDFToDouble(hotelid) (type: double), wthr_date (type: string)"
                              },
                              "outputColumnNames:": [
                                "_col0",
                                "_col25",
                                "_col34"
                              ],
                              "input vertices:": {
                                "1": "Map 6"
                              },
                              "Statistics:": "Num rows: 2960340 Data size: 1669632800 Basic stats: COMPLETE Column stats: NONE",
                              "HybridGraceHashJoin:": "true",
                              "OperatorId:": "MAPJOIN_81",
                              "children": {
                                "Select Operator": {
                                  "expressions:": "_col0 (type: bigint), round((_col25 - _col34), 1) (type: double)",
                                  "columnExprMap:": {
                                    "_col0": "_col0",
                                    "_col1": "round((_col25 - _col34), 1)"
                                  },
                                  "outputColumnNames:": [
                                    "_col0",
                                    "_col1"
                                  ],
                                  "Statistics:": "Num rows: 2960340 Data size: 1669632800 Basic stats: COMPLETE Column stats: NONE",
                                  "OperatorId:": "SEL_82",
                                  "children": {
                                    "Reduce Output Operator": {
                                      "columnExprMap:": {
                                        "KEY.reducesinkkey0": "_col0",
                                        "VALUE._col0": "_col1"
                                      },
                                      "key expressions:": "_col0 (type: bigint)",
                                      "sort order:": "+",
                                      "Map-reduce partition columns:": "_col0 (type: bigint)",
                                      "Statistics:": "Num rows: 2960340 Data size: 1669632800 Basic stats: COMPLETE Column stats: NONE",
                                      "value expressions:": "_col1 (type: double)",
                                      "OperatorId:": "RS_83",
                                      "outputname:": "Reducer 2",
                                      "outputOperator:": [
                                        "MAPJOIN_84"
                                      ]
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized"
          },
          "Map 5": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "tt2",
                  "columns:": [
                    "hotelid",
                    "avg_tmpr",
                    "wthr_date"
                  ],
                  "database:": "default",
                  "filterExpr:": "(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                  "Statistics:": "Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                  "table:": "hotel_weather",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_9",
                  "children": {
                    "Filter Operator": {
                      "predicate:": "(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                      "Statistics:": "Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                      "OperatorId:": "FIL_75",
                      "children": {
                        "Reduce Output Operator": {
                          "columnExprMap:": {
                            "KEY.reducesinkkey0": "UDFToDouble(hotelid)",
                            "KEY.reducesinkkey1": "wthr_date",
                            "VALUE._col2": "avg_tmpr"
                          },
                          "key expressions:": "UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                          "sort order:": "++",
                          "Map-reduce partition columns:": "UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                          "Statistics:": "Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                          "value expressions:": "avg_tmpr (type: double)",
                          "OperatorId:": "RS_76",
                          "outputname:": "Map 4",
                          "outputOperator:": [
                            "TS_8"
                          ]
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized"
          },
          "Map 6": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "tt3",
                  "columns:": [
                    "hotelid",
                    "avg_tmpr",
                    "wthr_date"
                  ],
                  "database:": "default",
                  "filterExpr:": "(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                  "Statistics:": "Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                  "table:": "hotel_weather",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_10",
                  "children": {
                    "Filter Operator": {
                      "predicate:": "(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                      "Statistics:": "Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                      "OperatorId:": "FIL_77",
                      "children": {
                        "Reduce Output Operator": {
                          "columnExprMap:": {
                            "KEY.reducesinkkey0": "UDFToDouble(hotelid)",
                            "KEY.reducesinkkey1": "wthr_date",
                            "VALUE._col2": "avg_tmpr"
                          },
                          "key expressions:": "UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                          "sort order:": "++",
                          "Map-reduce partition columns:": "UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                          "Statistics:": "Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                          "value expressions:": "avg_tmpr (type: double)",
                          "OperatorId:": "RS_78",
                          "outputname:": "Map 4",
                          "outputOperator:": [
                            "TS_8"
                          ]
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized"
          },
          "Map 7": {
            "Map Operator Tree:": [
              {
                "TableScan": {
                  "alias:": "t2",
                  "columns:": [
                    "hotelid",
                    "avg_tmpr_c",
                    "wthr_date"
                  ],
                  "database:": "default",
                  "filterExpr:": "(UDFToDouble(hotelid) is not null and CAST( wthr_date AS DATE) is not null) (type: boolean)",
                  "Statistics:": "Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE",
                  "table:": "kafka_hotel_weather",
                  "isTempTable:": "false",
                  "OperatorId:": "TS_22",
                  "children": {
                    "Filter Operator": {
                      "predicate:": "(UDFToDouble(hotelid) is not null and CAST( wthr_date AS DATE) is not null) (type: boolean)",
                      "Statistics:": "Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE",
                      "OperatorId:": "FIL_72",
                      "children": {
                        "Reduce Output Operator": {
                          "columnExprMap:": {
                            "KEY.reducesinkkey0": "UDFToDouble(hotelid)",
                            "KEY.reducesinkkey1": "CAST( wthr_date AS DATE)",
                            "VALUE._col6": "avg_tmpr_c"
                          },
                          "key expressions:": "UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)",
                          "sort order:": "++",
                          "Map-reduce partition columns:": "UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)",
                          "Statistics:": "Num rows: 1 Data size: 0 Basic stats: PARTIAL Column stats: NONE",
                          "value expressions:": "avg_tmpr_c (type: double)",
                          "OperatorId:": "RS_73",
                          "outputname:": "Map 1",
                          "outputOperator:": [
                            "TS_0"
                          ]
                        }
                      }
                    }
                  }
                }
              }
            ],
            "Execution mode:": "vectorized"
          },
          "Reducer 2": {
            "Execution mode:": "vectorized",
            "Reduce Operator Tree:": {
              "Map Join Operator": {
                "columnExprMap:": {
                  "_col0": "0:KEY.reducesinkkey0",
                  "_col1": "0:VALUE._col0",
                  "_col10": "0:VALUE._col9",
                  "_col2": "0:VALUE._col1",
                  "_col21": "1:VALUE._col0"
                },
                "condition map:": [
                  {
                    "": "Inner Join 0 to 1"
                  }
                ],
                "keys:": {
                  "0": "KEY.reducesinkkey0 (type: bigint)",
                  "1": "KEY.reducesinkkey0 (type: bigint)"
                },
                "outputColumnNames:": [
                  "_col0",
                  "_col1",
                  "_col2",
                  "_col10",
                  "_col21"
                ],
                "input vertices:": {
                  "1": "Map 4"
                },
                "Statistics:": "Num rows: 3256374 Data size: 1836596119 Basic stats: PARTIAL Column stats: NONE",
                "HybridGraceHashJoin:": "true",
                "OperatorId:": "MAPJOIN_84",
                "children": {
                  "Group By Operator": {
                    "aggregations:": [
                      "avg(_col10)"
                    ],
                    "columnExprMap:": {
                      "_col0": "_col0",
                      "_col1": "_col1",
                      "_col2": "_col2",
                      "_col3": "_col21"
                    },
                    "keys:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col21 (type: double)",
                    "mode:": "hash",
                    "outputColumnNames:": [
                      "_col0",
                      "_col1",
                      "_col2",
                      "_col3",
                      "_col4"
                    ],
                    "Statistics:": "Num rows: 3256374 Data size: 1836596119 Basic stats: PARTIAL Column stats: NONE",
                    "OperatorId:": "GBY_85",
                    "children": {
                      "Reduce Output Operator": {
                        "columnExprMap:": {
                          "KEY._col0": "_col0",
                          "KEY._col1": "_col1",
                          "KEY._col2": "_col2",
                          "KEY._col3": "_col3",
                          "VALUE._col0": "_col4"
                        },
                        "key expressions:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col3 (type: double)",
                        "sort order:": "++++",
                        "Map-reduce partition columns:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col3 (type: double)",
                        "Statistics:": "Num rows: 3256374 Data size: 1836596119 Basic stats: PARTIAL Column stats: NONE",
                        "value expressions:": "_col4 (type: struct<count:bigint,sum:double,input:double>)",
                        "OperatorId:": "RS_86",
                        "outputname:": "Reducer 3",
                        "outputOperator:": [
                          "GBY_87"
                        ]
                      }
                    }
                  }
                }
              }
            }
          },
          "Reducer 3": {
            "Execution mode:": "vectorized",
            "Reduce Operator Tree:": {
              "Group By Operator": {
                "aggregations:": [
                  "avg(VALUE._col0)"
                ],
                "columnExprMap:": {
                  "_col0": "KEY._col0",
                  "_col1": "KEY._col1",
                  "_col2": "KEY._col2",
                  "_col3": "KEY._col3"
                },
                "keys:": "KEY._col0 (type: bigint), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: double)",
                "mode:": "mergepartial",
                "outputColumnNames:": [
                  "_col0",
                  "_col1",
                  "_col2",
                  "_col3",
                  "_col4"
                ],
                "Statistics:": "Num rows: 1628187 Data size: 918298059 Basic stats: PARTIAL Column stats: NONE",
                "OperatorId:": "GBY_87",
                "children": {
                  "Select Operator": {
                    "expressions:": "_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), round(_col4, 1) (type: double), _col3 (type: double)",
                    "columnExprMap:": {
                      "_col0": "_col0",
                      "_col1": "_col1",
                      "_col2": "_col2",
                      "_col3": "round(_col4, 1)",
                      "_col4": "_col3"
                    },
                    "outputColumnNames:": [
                      "_col0",
                      "_col1",
                      "_col2",
                      "_col3",
                      "_col4"
                    ],
                    "Statistics:": "Num rows: 1628187 Data size: 918298059 Basic stats: PARTIAL Column stats: NONE",
                    "OperatorId:": "SEL_88",
                    "children": {
                      "File Output Operator": {
                        "compressed:": "false",
                        "Statistics:": "Num rows: 1628187 Data size: 918298059 Basic stats: PARTIAL Column stats: NONE",
                        "table:": {
                          "input format:": "org.apache.hadoop.mapred.SequenceFileInputFormat",
                          "output format:": "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                          "serde:": "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                        },
                        "OperatorId:": "FS_89"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "Stage-0": {
      "Fetch Operator": {
        "limit:": "-1",
        "Processor Tree:": {
          "ListSink": {
            "OperatorId:": "LIST_SINK_90"
          }
        }
      }
    }
  }
}