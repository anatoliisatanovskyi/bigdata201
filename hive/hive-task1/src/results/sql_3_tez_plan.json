{  
   "STAGE DEPENDENCIES":{  
      "Stage-1":{  
         "ROOT STAGE":"TRUE"
      },
      "Stage-0":{  
         "DEPENDENT STAGES":"Stage-1"
      }
   },
   "STAGE PLANS":{  
      "Stage-1":{  
         "Tez":{  
            "DagId:":"hive_20191210111758_495c9d3c-f3be-47fe-8301-b33d436f8d4b:48",
            "Edges:":{  
               "Map 1":[  
                  {  
                     "parent":"Map 3",
                     "type":"BROADCAST_EDGE"
                  },
                  {  
                     "parent":"Map 4",
                     "type":"BROADCAST_EDGE"
                  },
                  {  
                     "parent":"Map 5",
                     "type":"BROADCAST_EDGE"
                  }
               ],
               "Map 4":{  
                  "parent":"Map 5",
                  "type":"BROADCAST_EDGE"
               },
               "Reducer 2":{  
                  "parent":"Map 1",
                  "type":"SIMPLE_EDGE"
               }
            },
            "DagName:":"hive_20191210111758_495c9d3c-f3be-47fe-8301-b33d436f8d4b:48",
            "Vertices:":{  
               "Map 1":{  
                  "Map Operator Tree:":[  
                     {  
                        "TableScan":{  
                           "alias:":"tt1",
                           "columns:":[  
                              "id",
                              "srch_ci",
                              "srch_co",
                              "hotel_id"
                           ],
                           "database:":"default",
                           "filterExpr:":"(UDFToDouble(hotel_id) is not null and srch_co is not null and srch_ci is not null and id is not null) (type: boolean)",
                           "Statistics:":"Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                           "table:":"hdfs_expedia",
                           "isTempTable:":"false",
                           "OperatorId:":"TS_0",
                           "children":{  
                              "Filter Operator":{  
                                 "predicate:":"(UDFToDouble(hotel_id) is not null and srch_co is not null and srch_ci is not null and id is not null) (type: boolean)",
                                 "Statistics:":"Num rows: 2446563 Data size: 1379861760 Basic stats: COMPLETE Column stats: NONE",
                                 "OperatorId:":"FIL_91",
                                 "children":{  
                                    "Map Join Operator":{  
                                       "columnExprMap:":{  
                                          "_col0":"0:id",
                                          "_col12":"0:srch_ci",
                                          "_col19":"0:hotel_id",
                                          "_col25":"1:avg_tmpr"
                                       },
                                       "condition map:":[  
                                          {  
                                             "":"Inner Join 0 to 1"
                                          }
                                       ],
                                       "keys:":{  
                                          "0":"UDFToDouble(hotel_id) (type: double), srch_co (type: string)",
                                          "1":"UDFToDouble(hotelid) (type: double), wthr_date (type: string)"
                                       },
                                       "outputColumnNames:":[  
                                          "_col0",
                                          "_col12",
                                          "_col19",
                                          "_col25"
                                       ],
                                       "input vertices:":{  
                                          "1":"Map 5"
                                       },
                                       "Statistics:":"Num rows: 2691219 Data size: 1517847968 Basic stats: COMPLETE Column stats: NONE",
                                       "HybridGraceHashJoin:":"true",
                                       "OperatorId:":"MAPJOIN_92",
                                       "children":{  
                                          "Map Join Operator":{  
                                             "columnExprMap:":{  
                                                "_col0":"0:_col0",
                                                "_col25":"0:_col25",
                                                "_col34":"1:avg_tmpr"
                                             },
                                             "condition map:":[  
                                                {  
                                                   "":"Inner Join 0 to 1"
                                                }
                                             ],
                                             "keys:":{  
                                                "0":"UDFToDouble(_col19) (type: double), _col12 (type: string)",
                                                "1":"UDFToDouble(hotelid) (type: double), wthr_date (type: string)"
                                             },
                                             "outputColumnNames:":[  
                                                "_col0",
                                                "_col25",
                                                "_col34"
                                             ],
                                             "input vertices:":{  
                                                "1":"Map 3"
                                             },
                                             "Statistics:":"Num rows: 2960340 Data size: 1669632800 Basic stats: COMPLETE Column stats: NONE",
                                             "HybridGraceHashJoin:":"true",
                                             "OperatorId:":"MAPJOIN_93",
                                             "children":{  
                                                "Select Operator":{  
                                                   "expressions:":"_col0 (type: bigint), round((_col25 - _col34), 1) (type: double)",
                                                   "columnExprMap:":{  
                                                      "_col0":"_col0",
                                                      "_col1":"round((_col25 - _col34), 1)"
                                                   },
                                                   "outputColumnNames:":[  
                                                      "_col0",
                                                      "_col1"
                                                   ],
                                                   "Statistics:":"Num rows: 2960340 Data size: 1669632800 Basic stats: COMPLETE Column stats: NONE",
                                                   "OperatorId:":"SEL_94",
                                                   "children":{  
                                                      "Map Join Operator":{  
                                                         "columnExprMap:":{  
                                                            "_col0":"0:_col0",
                                                            "_col1":"0:_col1",
                                                            "_col17":"1:_col1",
                                                            "_col2":"0:_col2",
                                                            "_col9":"0:_col9"
                                                         },
                                                         "condition map:":[  
                                                            {  
                                                               "":"Inner Join 0 to 1"
                                                            }
                                                         ],
                                                         "keys:":{  
                                                            "0":"_col0 (type: bigint)",
                                                            "1":"_col0 (type: bigint)"
                                                         },
                                                         "outputColumnNames:":[  
                                                            "_col0",
                                                            "_col1",
                                                            "_col2",
                                                            "_col9",
                                                            "_col17"
                                                         ],
                                                         "input vertices:":{  
                                                            "0":"Map 4"
                                                         },
                                                         "Statistics:":"Num rows: 3256374 Data size: 1836596119 Basic stats: COMPLETE Column stats: NONE",
                                                         "HybridGraceHashJoin:":"true",
                                                         "OperatorId:":"MAPJOIN_95",
                                                         "children":{  
                                                            "Group By Operator":{  
                                                               "aggregations:":[  
                                                                  "avg(_col9)"
                                                               ],
                                                               "columnExprMap:":{  
                                                                  "_col0":"_col0",
                                                                  "_col1":"_col1",
                                                                  "_col2":"_col2",
                                                                  "_col3":"_col17"
                                                               },
                                                               "keys:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col17 (type: double)",
                                                               "mode:":"hash",
                                                               "outputColumnNames:":[  
                                                                  "_col0",
                                                                  "_col1",
                                                                  "_col2",
                                                                  "_col3",
                                                                  "_col4"
                                                               ],
                                                               "Statistics:":"Num rows: 3256374 Data size: 1836596119 Basic stats: COMPLETE Column stats: NONE",
                                                               "OperatorId:":"GBY_96",
                                                               "children":{  
                                                                  "Reduce Output Operator":{  
                                                                     "columnExprMap:":{  
                                                                        "KEY._col0":"_col0",
                                                                        "KEY._col1":"_col1",
                                                                        "KEY._col2":"_col2",
                                                                        "KEY._col3":"_col3",
                                                                        "VALUE._col0":"_col4"
                                                                     },
                                                                     "key expressions:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col3 (type: double)",
                                                                     "sort order:":"++++",
                                                                     "Map-reduce partition columns:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col3 (type: double)",
                                                                     "Statistics:":"Num rows: 3256374 Data size: 1836596119 Basic stats: COMPLETE Column stats: NONE",
                                                                     "value expressions:":"_col4 (type: struct<count:bigint,sum:double,input:double>)",
                                                                     "OperatorId:":"RS_97",
                                                                     "outputname:":"Reducer 2",
                                                                     "outputOperator:":[  
                                                                        "GBY_98"
                                                                     ]
                                                                  }
                                                               }
                                                            }
                                                         }
                                                      }
                                                   }
                                                }
                                             }
                                          }
                                       }
                                    }
                                 }
                              }
                           }
                        }
                     }
                  ],
                  "Execution mode:":"vectorized"
               },
               "Map 3":{  
                  "Map Operator Tree:":[  
                     {  
                        "TableScan":{  
                           "alias:":"tt3",
                           "columns:":[  
                              "hotelid",
                              "avg_tmpr",
                              "wthr_date"
                           ],
                           "database:":"default",
                           "filterExpr:":"(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                           "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                           "table:":"hotel_weather",
                           "isTempTable:":"false",
                           "OperatorId:":"TS_2",
                           "children":{  
                              "Filter Operator":{  
                                 "predicate:":"(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                                 "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                                 "OperatorId:":"FIL_82",
                                 "children":{  
                                    "Reduce Output Operator":{  
                                       "columnExprMap:":{  
                                          "KEY.reducesinkkey0":"UDFToDouble(hotelid)",
                                          "KEY.reducesinkkey1":"wthr_date",
                                          "VALUE._col2":"avg_tmpr"
                                       },
                                       "key expressions:":"UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                                       "sort order:":"++",
                                       "Map-reduce partition columns:":"UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                                       "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                                       "value expressions:":"avg_tmpr (type: double)",
                                       "OperatorId:":"RS_83",
                                       "outputname:":"Map 1",
                                       "outputOperator:":[  
                                          "TS_0"
                                       ]
                                    }
                                 }
                              }
                           }
                        }
                     }
                  ],
                  "Execution mode:":"vectorized"
               },
               "Map 4":{  
                  "Map Operator Tree:":[  
                     {  
                        "TableScan":{  
                           "alias:":"t1",
                           "columns:":[  
                              "id",
                              "user_id",
                              "hotel_id",
                              "visit_date"
                           ],
                           "database:":"default",
                           "filterExpr:":"(UDFToDouble(hotel_id) is not null and visit_date is not null and id is not null) (type: boolean)",
                           "Statistics:":"Num rows: 691251 Data size: 52535076 Basic stats: COMPLETE Column stats: NONE",
                           "table:":"long_stay_hotel_visit",
                           "isTempTable:":"true",
                           "OperatorId:":"TS_14",
                           "children":{  
                              "Filter Operator":{  
                                 "predicate:":"(UDFToDouble(hotel_id) is not null and visit_date is not null and id is not null) (type: boolean)",
                                 "Statistics:":"Num rows: 691251 Data size: 52535076 Basic stats: COMPLETE Column stats: NONE",
                                 "OperatorId:":"FIL_88",
                                 "children":{  
                                    "Map Join Operator":{  
                                       "columnExprMap:":{  
                                          "_col0":"0:id",
                                          "_col1":"0:user_id",
                                          "_col2":"0:hotel_id",
                                          "_col9":"1:avg_tmpr"
                                       },
                                       "condition map:":[  
                                          {  
                                             "":"Inner Join 0 to 1"
                                          }
                                       ],
                                       "keys:":{  
                                          "0":"UDFToDouble(hotel_id) (type: double), visit_date (type: date)",
                                          "1":"UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)"
                                       },
                                       "outputColumnNames:":[  
                                          "_col0",
                                          "_col1",
                                          "_col2",
                                          "_col9"
                                       ],
                                       "input vertices:":{  
                                          "1":"Map 5"
                                       },
                                       "Statistics:":"Num rows: 760376 Data size: 57788584 Basic stats: COMPLETE Column stats: NONE",
                                       "HybridGraceHashJoin:":"true",
                                       "OperatorId:":"MAPJOIN_89",
                                       "children":{  
                                          "Reduce Output Operator":{  
                                             "columnExprMap:":{  
                                                "KEY.reducesinkkey0":"_col0",
                                                "VALUE._col0":"_col1",
                                                "VALUE._col1":"_col2",
                                                "VALUE._col8":"_col9"
                                             },
                                             "key expressions:":"_col0 (type: bigint)",
                                             "sort order:":"+",
                                             "Map-reduce partition columns:":"_col0 (type: bigint)",
                                             "Statistics:":"Num rows: 760376 Data size: 57788584 Basic stats: COMPLETE Column stats: NONE",
                                             "value expressions:":"_col1 (type: int), _col2 (type: bigint), _col9 (type: double)",
                                             "OperatorId:":"RS_90",
                                             "outputname:":"Map 1",
                                             "outputOperator:":[  
                                                "TS_0"
                                             ]
                                          }
                                       }
                                    }
                                 }
                              }
                           }
                        }
                     }
                  ],
                  "Execution mode:":"vectorized"
               },
               "Map 5":{  
                  "Map Operator Tree:":[  
                     {  
                        "TableScan":{  
                           "alias:":"t2",
                           "columns:":[  
                              "hotelid",
                              "avg_tmpr",
                              "wthr_date"
                           ],
                           "database:":"default",
                           "filterExpr:":"((UDFToDouble(hotelid) is not null and CAST( wthr_date AS DATE) is not null) or (UDFToDouble(hotelid) is not null and wthr_date is not null)) (type: boolean)",
                           "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                           "table:":"hotel_weather",
                           "isTempTable:":"false",
                           "OperatorId:":"TS_15",
                           "children":[  
                              {  
                                 "Filter Operator":{  
                                    "predicate:":"(UDFToDouble(hotelid) is not null and CAST( wthr_date AS DATE) is not null) (type: boolean)",
                                    "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                                    "OperatorId:":"FIL_84",
                                    "children":{  
                                       "Reduce Output Operator":{  
                                          "columnExprMap:":{  
                                             "KEY.reducesinkkey0":"UDFToDouble(hotelid)",
                                             "KEY.reducesinkkey1":"CAST( wthr_date AS DATE)",
                                             "VALUE._col2":"avg_tmpr"
                                          },
                                          "key expressions:":"UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)",
                                          "sort order:":"++",
                                          "Map-reduce partition columns:":"UDFToDouble(hotelid) (type: double), CAST( wthr_date AS DATE) (type: date)",
                                          "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                                          "value expressions:":"avg_tmpr (type: double)",
                                          "OperatorId:":"RS_86",
                                          "outputname:":"Map 4",
                                          "outputOperator:":[  
                                             "TS_14"
                                          ]
                                       }
                                    }
                                 }
                              },
                              {  
                                 "Filter Operator":{  
                                    "predicate:":"(UDFToDouble(hotelid) is not null and wthr_date is not null) (type: boolean)",
                                    "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                                    "OperatorId:":"FIL_85",
                                    "children":{  
                                       "Reduce Output Operator":{  
                                          "columnExprMap:":{  
                                             "KEY.reducesinkkey0":"UDFToDouble(hotelid)",
                                             "KEY.reducesinkkey1":"wthr_date",
                                             "VALUE._col2":"avg_tmpr"
                                          },
                                          "key expressions:":"UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                                          "sort order:":"++",
                                          "Map-reduce partition columns:":"UDFToDouble(hotelid) (type: double), wthr_date (type: string)",
                                          "Statistics:":"Num rows: 10098 Data size: 1146300 Basic stats: COMPLETE Column stats: NONE",
                                          "value expressions:":"avg_tmpr (type: double)",
                                          "OperatorId:":"RS_87",
                                          "outputname:":"Map 1",
                                          "outputOperator:":[  
                                             "TS_0"
                                          ]
                                       }
                                    }
                                 }
                              }
                           ]
                        }
                     }
                  ],
                  "Execution mode:":"vectorized"
               },
               "Reducer 2":{  
                  "Execution mode:":"vectorized",
                  "Reduce Operator Tree:":{  
                     "Group By Operator":{  
                        "aggregations:":[  
                           "avg(VALUE._col0)"
                        ],
                        "columnExprMap:":{  
                           "_col0":"KEY._col0",
                           "_col1":"KEY._col1",
                           "_col2":"KEY._col2",
                           "_col3":"KEY._col3"
                        },
                        "keys:":"KEY._col0 (type: bigint), KEY._col1 (type: int), KEY._col2 (type: bigint), KEY._col3 (type: double)",
                        "mode:":"mergepartial",
                        "outputColumnNames:":[  
                           "_col0",
                           "_col1",
                           "_col2",
                           "_col3",
                           "_col4"
                        ],
                        "Statistics:":"Num rows: 1628187 Data size: 918298059 Basic stats: COMPLETE Column stats: NONE",
                        "OperatorId:":"GBY_98",
                        "children":{  
                           "Select Operator":{  
                              "expressions:":"_col0 (type: bigint), _col1 (type: int), _col2 (type: bigint), _col3 (type: double), round(_col4, 1) (type: double)",
                              "columnExprMap:":{  
                                 "_col0":"_col0",
                                 "_col1":"_col1",
                                 "_col2":"_col2",
                                 "_col3":"_col3",
                                 "_col4":"round(_col4, 1)"
                              },
                              "outputColumnNames:":[  
                                 "_col0",
                                 "_col1",
                                 "_col2",
                                 "_col3",
                                 "_col4"
                              ],
                              "Statistics:":"Num rows: 1628187 Data size: 918298059 Basic stats: COMPLETE Column stats: NONE",
                              "OperatorId:":"SEL_99",
                              "children":{  
                                 "File Output Operator":{  
                                    "compressed:":"false",
                                    "Statistics:":"Num rows: 1628187 Data size: 918298059 Basic stats: COMPLETE Column stats: NONE",
                                    "table:":{  
                                       "input format:":"org.apache.hadoop.mapred.SequenceFileInputFormat",
                                       "output format:":"org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",
                                       "serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                                    },
                                    "OperatorId:":"FS_100"
                                 }
                              }
                           }
                        }
                     }
                  }
               }
            }
         }
      },
      "Stage-0":{  
         "Fetch Operator":{  
            "limit:":"-1",
            "Processor Tree:":{  
               "ListSink":{  
                  "OperatorId:":"LIST_SINK_101"
               }
            }
         }
      }
   }
}